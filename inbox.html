<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Email Automation Agent - Inbox</title>
  <!-- Core Libraries -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
  <!-- Shared Styles -->
  <link rel="stylesheet" href="shared.css">
  <!-- Page Specific Styles -->
  <style>
    .conversation-scrollbox {
      height: 50vh;
      max-height: 50vh;
      overflow-y: auto;
      margin-bottom: 1rem;
    }
    .thread-messages {
      margin-bottom: 1rem;
    }
    .email-message {
      margin-bottom: 2rem;
      max-width: 600px;
    }
    .email-message.agent .message-box {
      padding: 0.75rem 1rem;
      border-radius: 0.5rem;
      background: #f7f9fc;
      border: 1px solid #e0e7ef;
      word-wrap: break-word;
      white-space: pre-wrap;
    }
    .email-message.customer .message-box {
      padding: 0.75rem 1rem;
      border-radius: 0.5rem;
      background: #ffffff;
      border: 1px solid #e0e7ef;
      word-wrap: break-word;
      white-space: pre-wrap;
    }
    .email-message .message-box p.email-body {
      margin-bottom: 0.5rem;
      white-space: pre-wrap;
    }
    .email-header {
      font-weight: 700;
      margin-bottom: 0.25rem;
    }
    .email-meta {
      font-size: 0.85rem;
      color: #6c757d;
      margin-bottom: 0.5rem;
    }
    .sender-role {
      font-style: italic;
      font-size: 0.85rem;
      color: #6c757d;
      margin-top: 0.25rem;
    }
    .message-footer {
      font-size: 0.75rem;
      color: #6c757d;
      margin-top: 0.25rem;
    }
    .reply-status-chip {
      font-size: 0.85rem;
      padding: 0.2rem 0.7rem;
      border-radius: 2rem;
      background: #fde68a;
      color: #92400e;
      display: inline-block;
      margin-left: 0.5rem;
      font-weight: 600;
    }
    .qa-indicator {
      font-size: 0.95rem;
    }
    .qa-indicator .badge {
      margin-right: 0.5rem;
    }
    @media (max-width: 991.98px) {
      .thread-header {
        flex-direction: column;
        gap: 0.5rem;
      }
      .email-message {
        max-width: 100%;
      }
    }
    .inbox-feed-item {
      transition: background-color 0.2s ease;
      cursor: pointer;
    }
    .inbox-feed-item:hover {
      background-color: #f2f5fa;
    }
    .avatar-circle {
      width: 48px;
      height: 48px;
      background-color: #e0e7ef;
      color: #3b82f6;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 1rem;
      user-select: none;
      flex-shrink: 0;
      border: none;
      box-shadow: none;
    }
    .email-message.agent {
      margin-left: auto;
    }
    .email-message.customer {
      margin-right: auto;
    }
    /* Custom scrollbar for scrollbox */
    .conversation-scrollbox::-webkit-scrollbar {
      width: 8px;
      background: #e0e7ef;
      border-radius: 8px;
    }
    .conversation-scrollbox::-webkit-scrollbar-thumb {
      background: #cbd5e1;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <div class="ea-wrapper">
    <!-- Sidebar -->
    <aside class="ea-sidebar">
      <div class="ea-sidebar-header">
        <a href="index.html" class="ea-sidebar-brand">
          <i class="bi bi-envelope-paper"></i>
          <span>Email Agent</span>
        </a>
        <button class="ea-sidebar-toggle d-lg-none" id="sidebarClose">
          <i class="bi bi-x-lg"></i>
        </button>
      </div>
      <ul class="ea-sidebar-menu">
        <li class="ea-sidebar-item">
          <a href="index.html" class="ea-sidebar-link">
            <i class="bi bi-speedometer2 ea-sidebar-icon"></i>
            <span>Dashboard</span>
          </a>
        </li>
        <li class="ea-sidebar-item">
          <a href="inbox.html" class="ea-sidebar-link active">
            <i class="bi bi-inbox ea-sidebar-icon"></i>
            <span>Inbox</span>
          </a>
        </li>
        <li class="ea-sidebar-item">
          <a href="automation.html" class="ea-sidebar-link">
            <i class="bi bi-lightning ea-sidebar-icon"></i>
            <span>Automation Rules</span>
          </a>
        </li>
        <li class="ea-sidebar-item">
          <a href="flowconnect.html" class="ea-sidebar-link">
            <i class="bi bi-diagram-3 ea-sidebar-icon"></i>
            <span>Workflow Builder</span>
          </a>
        </li>
        <li class="ea-sidebar-item">
          <a href="promptlib.html" class="ea-sidebar-link">
            <i class="bi bi-chat-left-text ea-sidebar-icon"></i>
            <span>Prompt Library</span>
          </a>
        </li>
        <li class="ea-sidebar-item">
          <a href="kbrules.html" class="ea-sidebar-link">
            <i class="bi bi-shield-check ea-sidebar-icon"></i>
            <span>Guardrails</span>
          </a>
        </li>
        <li class="ea-sidebar-item">
          <a href="insights.html" class="ea-sidebar-link">
            <i class="bi bi-graph-up ea-sidebar-icon"></i>
            <span>Data Insights</span>
          </a>
        </li>
        <li class="ea-sidebar-item">
          <a href="#" class="ea-sidebar-link">
            <i class="bi bi-gear ea-sidebar-icon"></i>
            <span>Settings</span>
          </a>
        </li>
        <li class="ea-sidebar-item">
          <a href="#" class="ea-sidebar-link">
            <i class="bi bi-question-circle ea-sidebar-icon"></i>
            <span>Help & Support</span>
          </a>
        </li>
      </ul>
    </aside>
    
    <!-- Sidebar Backdrop (Mobile) -->
    <div class="ea-sidebar-backdrop" id="sidebarBackdrop"></div>
    
    <!-- Main Content -->
    <main class="ea-main">
      <!-- Header -->
      <header class="ea-header">
        <div>
          <button class="btn btn-sm btn-light d-lg-none me-2" id="sidebarToggle">
            <i class="bi bi-list"></i>
          </button>
          <nav class="ea-breadcrumb">
            <li class="ea-breadcrumb-item"><a href="index.html">Home</a></li>
            <li class="ea-breadcrumb-item active">Inbox</li>
          </nav>
        </div>
        <div class="d-flex align-items-center">
          <div class="dropdown">
            <button class="btn btn-light dropdown-toggle" type="button" id="userDropdown" data-bs-toggle="dropdown" aria-expanded="false">
              <i class="bi bi-person-circle me-1"></i>
              <span>Admin</span>
            </button>
            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
              <li><a class="dropdown-item" href="#">Profile</a></li>
              <li><a class="dropdown-item" href="#">Settings</a></li>
              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item" href="#">Logout</a></li>
            </ul>
          </div>
        </div>
      </header>
      
      <!-- Content -->
      <div class="ea-content">
        <div class="row">
          <!-- Left Column: Inbox List -->
          <div class="col-lg-4 col-md-5 mb-4 mb-md-0">
            <div class="ea-card h-100 shadow-sm">
              <div class="ea-card-body d-flex flex-column">
                <!-- Email Account Selector -->
                <div class="d-flex justify-content-between align-items-center mb-3">
                  <div class="dropdown">
                    <button class="btn btn-outline-primary dropdown-toggle" type="button" id="emailAccountDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                      <i class="bi bi-envelope me-1"></i>
                      <span id="currentAccount">support@shopnow.com</span>
                    </button>
                    <ul class="dropdown-menu" aria-labelledby="emailAccountDropdown">
                      <li><a class="dropdown-item" href="#" onclick="switchAccount('support@shopnow.com')">support@shopnow.com</a></li>
                      <li><a class="dropdown-item" href="#" onclick="switchAccount('sales@shopnow.com')">sales@shopnow.com</a></li>
                      <li><a class="dropdown-item" href="#" onclick="switchAccount('info@shopnow.com')">info@shopnow.com</a></li>
                      <li><a class="dropdown-item" href="#" onclick="switchAccount('billing@shopnow.com')">billing@shopnow.com</a></li>
                    </ul>
                  </div>
                  <a href="task.html" class="btn btn-sm btn-outline-secondary">
                    <i class="bi bi-people me-1"></i> Agents
                  </a>
                </div>
                
                <!-- Inbox/Sent Tabs -->
                <ul class="nav nav-tabs mb-3" id="inboxTabs" role="tablist">
                  <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="inbox-tab" data-bs-toggle="tab" data-bs-target="#inbox-pane" type="button" role="tab" aria-controls="inbox-pane" aria-selected="true">
                      <i class="bi bi-inbox me-1"></i> Inbox
                    </button>
                  </li>
                  <li class="nav-item" role="presentation">
                    <button class="nav-link" id="sent-tab" data-bs-toggle="tab" data-bs-target="#sent-pane" type="button" role="tab" aria-controls="sent-pane" aria-selected="false">
                      <i class="bi bi-send me-1"></i> Sent
                    </button>
                  </li>
                </ul>
                <!-- Tab Content -->
                <div class="tab-content" id="inboxTabContent">
                  <!-- Inbox Tab -->
                  <div class="tab-pane fade show active" id="inbox-pane" role="tabpanel" aria-labelledby="inbox-tab">
                    <form class="mb-3">
                      <div class="input-group mb-2">
                        <input type="text" class="form-control" placeholder="Search emails...">
                        <button class="btn ea-btn-outline-secondary" type="button">
                          <span class="bi bi-search"></span>
                        </button>
                      </div>
                      <div class="row g-2">
                        <div class="col-4">
                          <select class="form-select" aria-label="Filter by priority">
                            <option selected>All Priority</option>
                            <option>High</option>
                            <option>Medium</option>
                            <option>Low</option>
                          </select>
                        </div>
                        <div class="col-4">
                          <select class="form-select" aria-label="Filter by status">
                            <option selected>All Status</option>
                            <option>Unread</option>
                            <option>Assigned</option>
                            <option>Replied</option>
                          </select>
                        </div>
                        <div class="col-4">
                          <select class="form-select" aria-label="Assign to agent">
                            <option selected>Assign Agent</option>
                            <option>Sarah Lee</option>
                            <option>Mike Chen</option>
                            <option>Emma Wilson</option>
                          </select>
                        </div>
                      </div>
                    </form>
                    <div class="overflow-auto flex-grow-1" style="max-height: 400px;">
                      <div class="d-flex align-items-center inbox-feed-item active p-2 border-bottom">
                        <input class="form-check-input me-2" type="checkbox" value="" id="email1">
                        <div class="avatar-circle me-3">JS</div>
                        <div class="flex-grow-1">
                          <div class="fw-bold">John Smith <span class="badge bg-danger ms-1">High</span></div>
                          <div class="small text-muted fw-semibold">Re: Meeting Follow Up</div>
                          <div class="small text-muted text-truncate" style="max-width: 180px;">Are you available next week to discuss the project?</div>
                          <div class="small text-success mt-1"><i class="bi bi-person-check me-1"></i>Assigned to: Sarah Lee</div>
                        </div>
                        <div class="text-end">
                          <span class="badge bg-warning text-dark mb-1">Unread</span>
                          <div class="small text-muted">2h ago</div>
                        </div>
                      </div>
                      <div class="d-flex align-items-center inbox-feed-item p-2 border-bottom">
                        <input class="form-check-input me-2" type="checkbox" value="" id="email2">
                        <div class="avatar-circle me-3">JD</div>
                        <div class="flex-grow-1">
                          <div class="fw-bold">Jane Doe <span class="badge bg-warning ms-1">Medium</span></div>
                          <div class="small text-muted fw-semibold">Project Update</div>
                          <div class="small text-muted text-truncate" style="max-width: 180px;">Here's the latest update on the project timeline.</div>
                          <div class="small text-primary mt-1"><i class="bi bi-robot me-1"></i>AI Processing</div>
                        </div>
                        <div class="text-end">
                          <span class="badge bg-info text-dark mb-1">Processing</span>
                          <div class="small text-muted">4h ago</div>
                        </div>
                      </div>
                      <div class="d-flex align-items-center inbox-feed-item p-2 border-bottom">
                        <input class="form-check-input me-2" type="checkbox" value="" id="email3">
                        <div class="avatar-circle me-3">AC</div>
                        <div class="flex-grow-1">
                          <div class="fw-bold">Acme Corp <span class="badge bg-secondary ms-1">Low</span></div>
                          <div class="small text-muted fw-semibold">Quarterly Report</div>
                          <div class="small text-muted text-truncate" style="max-width: 180px;">Please review the attached quarterly financial report.</div>
                          <div class="small text-success mt-1"><i class="bi bi-person-check me-1"></i>Assigned to: Mike Chen</div>
                        </div>
                        <div class="text-end">
                          <span class="badge bg-success mb-1">Replied</span>
                          <div class="small text-muted">1d ago</div>
                        </div>
                      </div>
                      <div class="d-flex align-items-center inbox-feed-item p-2 border-bottom">
                        <input class="form-check-input me-2" type="checkbox" value="" id="email4">
                        <div class="avatar-circle me-3">EC</div>
                        <div class="flex-grow-1">
                          <div class="fw-bold">Emily Carter <span class="badge bg-danger ms-1">High</span></div>
                          <div class="small text-muted fw-semibold">Product Return Policy</div>
                          <div class="small text-muted text-truncate" style="max-width: 180px;">I need to return a jacket that doesn't fit...</div>
                          <div class="small text-success mt-1"><i class="bi bi-person-check me-1"></i>Assigned to: Emma Wilson</div>
                        </div>
                        <div class="text-end">
                          <span class="badge bg-success mb-1">Replied</span>
                          <div class="small text-muted">2d ago</div>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Sent Tab -->
                  <div class="tab-pane fade" id="sent-pane" role="tabpanel" aria-labelledby="sent-tab">
                    <form class="mb-3">
                      <div class="input-group mb-2">
                        <input type="text" class="form-control" placeholder="Search sent emails...">
                        <button class="btn ea-btn-outline-secondary" type="button">
                          <span class="bi bi-search"></span>
                        </button>
                      </div>
                      <div class="row g-2">
                        <div class="col-6">
                          <select class="form-select" aria-label="Filter by date">
                            <option selected>All Time</option>
                            <option>Today</option>
                            <option>This Week</option>
                            <option>This Month</option>
                          </select>
                        </div>
                        <div class="col-6">
                          <select class="form-select" aria-label="Filter by sender">
                            <option selected>All Senders</option>
                            <option>AI Agent</option>
                            <option>Sarah Lee</option>
                            <option>Mike Chen</option>
                            <option>Emma Wilson</option>
                          </select>
                        </div>
                      </div>
                    </form>
                    <div class="overflow-auto flex-grow-1" style="max-height: 400px;">
                      <div class="d-flex align-items-center inbox-feed-item p-2 border-bottom">
                        <div class="avatar-circle me-3 bg-success text-white">AI</div>
                        <div class="flex-grow-1">
                          <div class="fw-bold">To: John Smith</div>
                          <div class="small text-muted fw-semibold">Re: Meeting Follow Up</div>
                          <div class="small text-muted text-truncate" style="max-width: 180px;">Thank you for your inquiry. I'll check my calendar...</div>
                          <div class="small text-primary mt-1"><i class="bi bi-robot me-1"></i>Sent by AI Agent</div>
                        </div>
                        <div class="text-end">
                          <span class="badge bg-success mb-1">Delivered</span>
                          <div class="small text-muted">1h ago</div>
                        </div>
                      </div>
                      <div class="d-flex align-items-center inbox-feed-item p-2 border-bottom">
                        <div class="avatar-circle me-3">SL</div>
                        <div class="flex-grow-1">
                          <div class="fw-bold">To: Emily Carter</div>
                          <div class="small text-muted fw-semibold">Re: Product Return Policy</div>
                          <div class="small text-muted text-truncate" style="max-width: 180px;">I've sent you the return label and instructions...</div>
                          <div class="small text-success mt-1"><i class="bi bi-person-check me-1"></i>Sent by Sarah Lee</div>
                        </div>
                        <div class="text-end">
                          <span class="badge bg-success mb-1">Delivered</span>
                          <div class="small text-muted">3h ago</div>
                        </div>
                      </div>
                      <div class="d-flex align-items-center inbox-feed-item p-2 border-bottom">
                        <div class="avatar-circle me-3">MC</div>
                        <div class="flex-grow-1">
                          <div class="fw-bold">To: Acme Corp</div>
                          <div class="small text-muted fw-semibold">Re: Quarterly Report</div>
                          <div class="small text-muted text-truncate" style="max-width: 180px;">Thank you for the quarterly report. I've reviewed...</div>
                          <div class="small text-success mt-1"><i class="bi bi-person-check me-1"></i>Sent by Mike Chen</div>
                        </div>
                        <div class="text-end">
                          <span class="badge bg-success mb-1">Delivered</span>
                          <div class="small text-muted">1d ago</div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- Bulk Actions -->
                <div class="d-flex justify-content-between align-items-center mb-3">
                  <div>
                    <button class="btn btn-sm btn-outline-primary" onclick="assignSelectedEmails()">
                      <i class="bi bi-person-plus me-1"></i> Assign Selected
                    </button>
                    <button class="btn btn-sm btn-outline-secondary" onclick="markAsRead()">
                      <i class="bi bi-envelope-open me-1"></i> Mark Read
                    </button>
                  </div>
                  <div class="small text-muted">
                    <span id="emailCount">4 emails</span>
                  </div>
                </div>
          </div>
        </div>
      </div>
      <!-- Right Column: Email Thread Viewer -->
      <div class="col-lg-8 col-md-7">
        <div class="ea-card h-100 shadow-sm">
          <div class="ea-card-body d-flex flex-column">
            <!-- Thread Header -->
            <div class="thread-header d-flex justify-content-between align-items-center mb-3 flex-wrap">
              <div>
                <h5 class="mb-1">Re: Product Return Policy Inquiry</h5>
                <div class="text-muted small">From: Emily Carter &lt;emily.carter@email.com&gt; | 2024-06-14 09:12 AM</div>
              </div>
              <div>
                <span class="reply-status-chip">Human Agent Takeover</span>
              </div>
            </div>
            <!-- QA Summary Box -->
            <div class="card mb-3 mt-0 mb-4">
              <div class="card-body">
                <h6 class="card-title mb-2">QA Summary</h6>
                <div class="qa-indicator mb-2">
                  <span class="badge badge-qa-tone">Tone: Professional</span>
                  <span class="badge badge-qa-compliance">Compliance: Pass</span>
                  <span class="badge badge-qa-flagged">Flagged: "ASAP"</span>
                </div>
                <div class="small text-muted">No critical issues detected.</div>
              </div>
            </div>
            <!-- Thread Messages (scrollable) -->
            <div class="conversation-scrollbox mb-3">
              <div class="thread-messages">
                <div class="email-message customer d-flex justify-content-start flex-column align-items-start">
                  <div class="message-box">
                    <div class="email-header">From: Emily Carter</div>
                    <div class="email-meta">Sent: 2024-06-14 09:12 AM</div>
                    <div class="email-header">To: Support Team &lt;support@shopnow.com&gt;</div>
                    <div class="email-header">Subject: Product Return Policy</div>
                    <p class="email-body">Hello,
<br>
I recently purchased a jacket from your store, but it doesn't fit as expected. Could you please let me know what your return policy is and how I can initiate a return?
<br>
Thank you,
<br>
Emily
                    </p>
                  </div>
                  <div class="sender-role">Customer</div>
                  <div class="message-footer">Received</div>
                </div>
                <div class="email-message agent d-flex justify-content-end flex-column align-items-end">
                  <div class="message-box">
                    <div class="email-header">From: ShopNow AI Assistant</div>
                    <div class="email-meta">Sent: 2024-06-14 09:14 AM</div>
                    <div class="email-header">To: Emily Carter &lt;emily.carter@email.com&gt;</div>
                    <div class="email-header">Subject: Re: Product Return Policy</div>
                    <p class="email-body">Hello Emily,
<br>
Thank you for reaching out regarding your recent purchase.
<br><br>
Our return policy allows for returns within 30 days of delivery, provided the item is in its original condition with tags attached. To initiate a return, please reply to this email with your order number, and we will send you a prepaid return shipping label and further instructions.
<br><br>
If you have any other questions, feel free to ask!
<br><br>
Best regards,<br>
ShopNow Customer Support
                    </p>
                  </div>
                  <div class="sender-role">AI</div>
                  <div class="message-footer">Sent via Email Agent · Generated by Email Agent AI</div>
                </div>
                <div class="email-message customer d-flex justify-content-start flex-column align-items-start">
                  <div class="message-box">
                    <div class="email-header">From: Emily Carter</div>
                    <div class="email-meta">Sent: 2024-06-14 09:15 AM</div>
                    <div class="email-header">To: ShopNow AI Assistant</div>
                    <div class="email-header">Subject: Re: Product Return Policy</div>
                    <p class="email-body">Hi,  
Thank you for the details. My order number is <strong>#A123456</strong>.  
Looking forward to your instructions.</p>
                  </div>
                  <div class="sender-role">Customer</div>
                  <div class="message-footer">Received</div>
                </div>
                <div class="email-message agent d-flex justify-content-end flex-column align-items-end">
                  <div class="message-box">
                    <div class="email-header">From: Sarah Lee</div>
                    <div class="email-meta">Sent: 2024-06-14 09:17 AM</div>
                    <div class="email-header">To: Emily Carter &lt;emily.carter@email.com&gt;</div>
                    <div class="email-header">Subject: Re: Return Request Confirmation</div>
                    <p class="email-body">Hi Emily,
<br>
Thank you for confirming your order number. I have just emailed you a prepaid return shipping label and instructions for sending the jacket back to us. Once we receive and inspect the item, we will process your refund within 2-3 business days.
<br><br>
Please let us know if you need any further assistance.
<br><br>
Best,<br>
Sarah Lee<br>
ShopNow Customer Support
                    </p>
                  </div>
                  <div class="sender-role">Agent</div>
                  <div class="message-footer">Sent via Email Agent · Human Agent</div>
                </div>
              </div>
            </div>
            <!-- Show AI Reply Modal Button -->
            <div class="d-flex justify-content-end mb-3">
              <button type="button" class="btn btn-outline-info" data-bs-toggle="modal" data-bs-target="#aiReplyModal">
                View AI Suggested Reply
              </button>
            </div>
            <!-- Action Buttons -->
            <div class="d-flex flex-wrap gap-2 mb-3">
              <button type="button" class="btn btn-secondary">Archive</button>
              <button type="button" class="btn btn-primary" style="background: #e5ecfb; color: #3b82f6;">Edit Prompt</button>
              <button type="button" class="btn btn-info">Schedule</button>
              <button type="button" class="btn btn-success">Send</button>
            </div>
            <!-- Assignment and Reply Actions -->
            <div class="d-flex justify-content-between align-items-center">
              <div class="dropdown">
                <button class="btn btn-outline-warning dropdown-toggle" type="button" id="assignDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                  <i class="bi bi-person-plus me-1"></i> Assign to Agent
                </button>
                <ul class="dropdown-menu" aria-labelledby="assignDropdown">
                  <li><a class="dropdown-item" href="#" onclick="assignToAgent('Sarah Lee')">Sarah Lee</a></li>
                  <li><a class="dropdown-item" href="#" onclick="assignToAgent('Mike Chen')">Mike Chen</a></li>
                  <li><a class="dropdown-item" href="#" onclick="assignToAgent('Emma Wilson')">Emma Wilson</a></li>
                  <li><hr class="dropdown-divider"></li>
                  <li><a class="dropdown-item" href="#" onclick="assignToAgent('AI Agent')">Reassign to AI</a></li>
                </ul>
              </div>
              <button type="button" class="btn btn-dark" data-bs-toggle="modal" data-bs-target="#humanReplyModal">
                Reply as Human Agent
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>

<!-- Human Agent Reply Modal -->
<div class="modal fade" id="humanReplyModal" tabindex="-1" aria-labelledby="humanReplyModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="humanReplyModalLabel">Reply as Human Agent</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="mb-3">
          <label for="humanReplyTextarea" class="form-label">Your Reply</label>
          <textarea class="form-control" id="humanReplyTextarea" rows="7" placeholder="Type your reply here..."></textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary">Send Reply</button>
      </div>
    </div>
  </div>
</div>

<!-- AI Reply Modal -->
<div class="modal fade" id="aiReplyModal" tabindex="-1" aria-labelledby="aiReplyModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="aiReplyModalLabel">Suggested AI Reply</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="small text-muted mb-1">Prompt Used (2024-06-14 09:13 AM):</div>
        <div class="bg-light rounded p-2 small mb-2">
          "Draft a courteous reply explaining the return policy and next steps for a customer wishing to return an item."
        </div>
        <div class="small mb-2"><strong>Template:</strong> Product Return Policy Response</div>
        <div class="bg-white rounded border p-3 mb-3" style="font-size: 0.95rem;">
          <strong>Suggested Reply (AI-Generated):</strong>
          <div class="mt-2" style="white-space: pre-wrap;">
            Hello Emily,

            Thank you for reaching out regarding your recent purchase.

            Our return policy allows for returns within 30 days of delivery, provided the item is in its original condition with tags attached. To initiate a return, please reply to this email with your order number, and we will send you a prepaid return shipping label and further instructions.

            If you have any other questions, feel free to ask!

            Best regards,  
            ShopNow Customer Support
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <div class="d-flex flex-wrap gap-2">
          <button type="button" class="btn btn-outline-secondary">Regenerate</button>
          <button type="button" class="btn btn-outline-primary">Edit Prompt</button>
          <button type="button" class="btn btn-success">Accept & Send</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Bootstrap JS Bundle (with Popper) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<!-- Bootstrap Icons CDN (for search icon) -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

<!-- Sidebar Toggle Script -->
<script>
  // Sidebar toggle functionality
  document.addEventListener('DOMContentLoaded', function() {
    const sidebarToggle = document.getElementById('sidebarToggle');
    const sidebar = document.querySelector('.ea-sidebar');
    const sidebarClose = document.getElementById('sidebarClose');
    const sidebarBackdrop = document.getElementById('sidebarBackdrop');
    
    if (sidebarToggle) {
      sidebarToggle.addEventListener('click', function() {
        sidebar.classList.add('show');
        sidebarBackdrop.classList.add('show');
      });
    }
    
    if (sidebarClose) {
      sidebarClose.addEventListener('click', function() {
        sidebar.classList.remove('show');
        sidebarBackdrop.classList.remove('show');
      });
    }
    
    if (sidebarBackdrop) {
      sidebarBackdrop.addEventListener('click', function() {
        sidebar.classList.remove('show');
        sidebarBackdrop.classList.remove('show');
      });
    }
  });

  // Commercial Inbox Features
  function switchAccount(accountEmail) {
    document.getElementById('currentAccount').textContent = accountEmail;
    // Simulate loading emails for the selected account
    console.log('Switched to account:', accountEmail);
    // In a real application, this would trigger an API call to load emails for the selected account
  }

  function assignToAgent(agentName) {
    // Get the currently selected email (in a real app, this would be based on the active email)
    const currentEmail = document.querySelector('.inbox-feed-item.active');
    if (currentEmail) {
      const assignmentInfo = currentEmail.querySelector('.small.text-success, .small.text-primary');
      if (assignmentInfo) {
        if (agentName === 'AI Agent') {
          assignmentInfo.innerHTML = '<i class="bi bi-robot me-1"></i>AI Processing';
          assignmentInfo.className = 'small text-primary mt-1';
        } else {
          assignmentInfo.innerHTML = `<i class="bi bi-person-check me-1"></i>Assigned to: ${agentName}`;
          assignmentInfo.className = 'small text-success mt-1';
        }
      }
    }
    console.log('Assigned current email to:', agentName);
  }

  function assignSelectedEmails() {
    const selectedEmails = document.querySelectorAll('input[type="checkbox"]:checked');
    if (selectedEmails.length === 0) {
      alert('Please select emails to assign.');
      return;
    }
    
    const agent = prompt('Enter agent name (Sarah Lee, Mike Chen, Emma Wilson):');
    if (agent) {
      selectedEmails.forEach(checkbox => {
        const emailItem = checkbox.closest('.inbox-feed-item');
        const assignmentInfo = emailItem.querySelector('.small.text-success, .small.text-primary');
        if (assignmentInfo) {
          assignmentInfo.innerHTML = `<i class="bi bi-person-check me-1"></i>Assigned to: ${agent}`;
          assignmentInfo.className = 'small text-success mt-1';
        }
        checkbox.checked = false;
      });
      console.log(`Assigned ${selectedEmails.length} emails to ${agent}`);
    }
  }

  function markAsRead() {
    const selectedEmails = document.querySelectorAll('input[type="checkbox"]:checked');
    if (selectedEmails.length === 0) {
      alert('Please select emails to mark as read.');
      return;
    }
    
    selectedEmails.forEach(checkbox => {
      const emailItem = checkbox.closest('.inbox-feed-item');
      const statusBadge = emailItem.querySelector('.badge');
      if (statusBadge && statusBadge.textContent === 'Unread') {
        statusBadge.textContent = 'Read';
        statusBadge.className = 'badge bg-secondary mb-1';
      }
      checkbox.checked = false;
    });
    console.log(`Marked ${selectedEmails.length} emails as read`);
  }

  // Tab switching functionality
  document.addEventListener('DOMContentLoaded', function() {
    const tabButtons = document.querySelectorAll('#inboxTabs button[data-bs-toggle="tab"]');
    tabButtons.forEach(button => {
      button.addEventListener('click', function() {
        const targetTab = this.getAttribute('data-bs-target');
        console.log('Switched to tab:', targetTab);
        // In a real application, this could trigger loading different data sets
      });
    });
  });
</script>
</body>
</html>